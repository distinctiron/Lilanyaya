title,body,labels
"Epic 1 — Story 1.1: Create world from template","User story:\nAs a paid user, I want to create a world from a template so that I can start quickly with sensible defaults.\n\nAcceptance criteria:\n- Template picker offers Prisoner’s Dilemma v1, Blank, Custom Matrix Game.\n- Form captures name, description, visibility (public/private) and persists.\n- Redirects to world detail page after save; shows next-step guidance.\n\nTechnical notes:\n- Persist to worlds table (name, description, visibility, owner_user_id, version).\n- Initialize schema_doc with template defaults.\n\nLinks:\n- docs/stories/epic-1-world-creator.md#story-11--create-world-from-template\n- docs/architecture/world-schema-and-kpis.md","epic:world-creator,type:feature,priority:high"
"Epic 1 — Story 1.2: Define rules (decisions, outcomes, policy, iterations)","User story:\nAs a world creator, I want to define rules so that simulations behave as specified.\n\nAcceptance criteria:\n- Decision space is an array; outcome space auto-derived with manual override.\n- Interaction policy options: all_pairs, round_robin, random; validation on change.\n- Iterations must be a positive integer; invalid inputs are blocked with inline error.\n\nTechnical notes:\n- Update schema_doc fields decisions.allowed, outcomes.allowed, interaction.policy, time.iterations.\n- Client derives outcomes from decisions × decisions; allow override.\n\nLinks:\n- docs/stories/epic-1-world-creator.md#story-12--define-rules-decisions-outcomes-policy-iterations\n- docs/architecture/world-schema-and-kpis.md","epic:world-creator,type:feature"
"Epic 1 — Story 1.3: Configure determinism and randomness","User story:\nAs a world creator, I want deterministic seeds and optional schedule randomization so that runs are reproducible yet flexible.\n\nAcceptance criteria:\n- rng_seed is required and persisted.\n- schedule_randomization toggle appears when policy is random; uses seeded shuffles.\n- World schema preview reflects chosen settings.\n\nTechnical notes:\n- Update determinism.rng_seed and randomness.schedule_randomization in schema_doc.\n- Simulation manifest records seed and randomization mode.\n\nLinks:\n- docs/stories/epic-1-world-creator.md#story-13--configure-determinism-and-randomness\n- docs/architecture/simulation-engine-and-scheduling.md","epic:world-creator,type:feature"
"Epic 1 — Story 1.4: Set scoring and payoff","User story:\nAs a world creator, I want to define payoff and scoring so that rankings reflect my world.\n\nAcceptance criteria:\n- Payoff matrix editor with Prisoner’s Dilemma defaults; prevents missing cells.\n- Scoring options: sum | average | discounted (gamma input shown only when selected).\n- Function reference input visible but disabled (future use).\n\nTechnical notes:\n- Update payoff (type, matrix) and scoring in schema_doc; validate matrix completeness.\n\nLinks:\n- docs/stories/epic-1-world-creator.md#story-14--set-scoring-and-payoff\n- docs/architecture/world-schema-and-kpis.md","epic:world-creator,type:feature"
"Epic 1 — Story 1.5: Configure state and state update","User story:\nAs a world creator, I want to configure state so that the engine can track histories and rounds.\n\nAcceptance criteria:\n- Initial state shows round and history defaults; editable JSON with schema validation.\n- Built‑in update selector (pd.update_state) selectable; custom updates disabled (future).\n\nTechnical notes:\n- Update state.initial and state.update in schema_doc; perform JSON schema validation on save.\n\nLinks:\n- docs/stories/epic-1-world-creator.md#story-15--configure-state-and-state-update\n- docs/architecture/world-schema-and-kpis.md","epic:world-creator,type:feature"
"Epic 1 — Story 1.6: Build Key Performance Indicators","User story:\nAs a world creator, I want to define Key Performance Indicators so that I can track important signals.\n\nAcceptance criteria:\n- Builder supports scope (world/actor/pair), filters, window, aggregation.\n- Save/list/delete Key Performance Indicators per world.\n- Latest run snapshot values rendered on the world page.\n\nTechnical notes:\n- Persist to kpi_definitions; compute snapshots post‑run into kpi_snapshots.\n\nLinks:\n- docs/stories/epic-1-world-creator.md#story-16--build-key-performance-indicators\n- docs/architecture/world-schema-and-kpis.md","epic:world-creator,type:feature,area:analytics"
"Epic 1 — Story 1.7: Seed baseline actors","User story:\nAs a world creator, I want baseline actors so that entrants have references.\n\nAcceptance criteria:\n- One‑click add Always Cooperate, Always Defect, Tit For Tat, Win‑Stay/Lose‑Shift.\n- actor_strategy_mode governs whether duplicates are allowed.\n\nTechnical notes:\n- Insert actors referencing builtin strategies; enforce uniqueness when one_to_one.\n\nLinks:\n- docs/stories/epic-1-world-creator.md#story-17--seed-baseline-actors","epic:world-creator,type:feature"
"Epic 1 — Story 1.8: Validate world (10‑run sanity)","User story:\nAs a world creator, I want a sanity check so that obvious issues are caught early.\n\nAcceptance criteria:\n- Triggers a 10‑run deterministic job; artifacts are stored.\n- Summary view shows pairwise averages and any errors/outliers.\n\nTechnical notes:\n- Enqueue a run with iterations=as configured, repeat=10; seed fixed.\n- Save run_summary and pairwise_matrix; surface status.\n\nLinks:\n- docs/stories/epic-1-world-creator.md#story-18--validate-world-10run-sanity\n- docs/architecture/simulation-engine-and-scheduling.md","epic:world-creator,type:feature,area:engine"
"Epic 1 — Story 1.9: Publish world page","User story:\nAs a world creator, I want to publish the world so that others can view and participate.\n\nAcceptance criteria:\n- Public overview includes rules, assumptions, Key Performance Indicators, leaderboards, and seeds.\n- Submission policy configurable: open/curated/invite-only; enforced on submissions.\n\nTechnical notes:\n- Public route `/worlds/{id}`; server filters private content; policy stored in schema_doc or separate column.\n\nLinks:\n- docs/stories/epic-1-world-creator.md#story-19--publish-world-page","epic:world-creator,type:feature,area:web"
"Epic 2 — Story 2.1: Choose authoring mode (Natural Language | Code)","User story:\nAs a strategy creator, I want to choose Natural Language or Code at creation so that I can use the best tool for my skillset.\n\nAcceptance criteria:\n- Mode toggle is required on first save and becomes read‑only thereafter.\n- UI adjusts fields and validation rules per mode.\n\nTechnical notes:\n- Persist mode on strategies.type; enforce immutability after first save.\n\nLinks:\n- docs/stories/epic-2-strategy-creator.md#story-21--choose-authoring-mode","epic:strategy-creator,type:feature"
"Epic 2 — Story 2.2: Natural Language → Finite State Machine compile","User story:\nAs a creator, I want my natural language prompt compiled to a Finite State Machine so that it runs safely and is explainable.\n\nAcceptance criteria:\n- Compiler validates guards, actions, and decision set.\n- Preview renders states, transitions, and two sample traces (vs Always Cooperate/Always Defect).\n- Errors point to the offending rule with suggestions.\n\nTechnical notes:\n- Implement prompt → FSM compiler; reuse counters/guards from strategy spec.\n\nLinks:\n- docs/stories/epic-2-strategy-creator.md#story-22--natural-language--finite-state-machine-compile\n- docs/architecture/strategy-dsl-and-sandbox.md","epic:strategy-creator,type:feature,area:compiler"
"Epic 2 — Story 2.3: Code strategy editor (sandboxed)","User story:\nAs an advanced creator, I want to implement a constrained function so that I can express behavior as code safely.\n\nAcceptance criteria:\n- Editor shows interface contract (input shape and allowed outputs) and language selector.\n- Save runs static checks (signature, forbidden globals/imports, size).\n- Runtime enforces timeout and memory limits; invalid outputs are rejected with clear errors.\n\nTechnical notes:\n- Sandboxed runtime (e.g., isolated VM or subprocess) with no I/O; deterministic inputs.\n\nLinks:\n- docs/stories/epic-2-strategy-creator.md#story-23--code-strategy-editor-sandboxed\n- docs/architecture/strategy-dsl-and-sandbox.md#code-strategy-interface-optional-sandboxed","epic:strategy-creator,type:feature,area:sandbox"
"Epic 2 — Story 2.4: Static preview (no compute)","User story:\nAs a creator, I want a static preview so that I can verify structure before spending runs.\n\nAcceptance criteria:\n- Behavior summary with validation results and, for Natural Language, state/transition diagram.\n- No quota is consumed.\n\nTechnical notes:\n- For Code mode, run static analysis only; no execution.\n\nLinks:\n- docs/stories/epic-2-strategy-creator.md#story-24--static-preview-no-compute","epic:strategy-creator,type:feature"
"Epic 2 — Story 2.5: Quick Test (subscriber)","User story:\nAs a subscriber, I want a 10‑run quick test vs baselines so that I can gauge behavior fast.\n\nAcceptance criteria:\n- Deterministic seed used; per‑opponent mini‑cards show averages and outcome mix.\n- Free users see a teaser with upgrade call to action.\n\nTechnical notes:\n- Enqueue small run set; use baseline actors from the world.\n\nLinks:\n- docs/stories/epic-2-strategy-creator.md#story-25--quick-test-subscriber","epic:strategy-creator,type:feature,gating:subscriber"
"Epic 2 — Story 2.6: Full simulation","User story:\nAs a creator, I want to run full simulations so that I can get ranked, reproducible results.\n\nAcceptance criteria:\n- User selects iterations, seed, and policy (respecting world settings); quotas enforced.\n- Artifacts (summary, pairwise, traces if enabled) are persisted and linked.\n\nTechnical notes:\n- POST /runs enqueues; GET /runs/{id} returns status and summary; artifacts via signed URLs.\n\nLinks:\n- docs/stories/epic-2-strategy-creator.md#story-26--full-simulation\n- docs/architecture/simulation-engine-and-scheduling.md","epic:strategy-creator,type:feature,area:engine"
"Epic 2 — Story 2.7: Versioning","User story:\nAs a creator, I want to version my strategy so that I can iterate safely.\n\nAcceptance criteria:\n- Save with notes creates a new immutable version; list and revert supported.\n- Published link points to latest by default; specific versions linkable.\n\nTechnical notes:\n- strategies.version increments; run_actors.snapshot stores version used.\n\nLinks:\n- docs/stories/epic-2-strategy-creator.md#story-27--versioning","epic:strategy-creator,type:feature"
"Epic 2 — Story 2.8: Publish strategy","User story:\nAs a creator, I want to publish my strategy so that others can view and compete against it.\n\nAcceptance criteria:\n- Visibility control (public/private); optional readme/description.\n- Shareable link displays performance summary and world compatibility.\n\nTechnical notes:\n- strategies.visibility controls listing; public page shows latest summary if available.\n\nLinks:\n- docs/stories/epic-2-strategy-creator.md#story-28--publish-strategy","epic:strategy-creator,type:feature,area:web"
"Epic 3 — Story 3.1: Seeded pseudorandom initialization","User story:\nAs a system, I need to initialize a single seed so that all randomization is reproducible.\n\nAcceptance criteria:\n- Run manifest records the seed; all schedule randomness derives from it.\n- Re‑running with same inputs and seed yields identical outputs.\n\nTechnical notes:\n- Deterministic pseudorandom number generator seeded once per run; passed to scheduler.\n\nLinks:\n- docs/stories/epic-3-simulation-engine.md#story-31--seeded-pseudorandom-initialization","epic:engine,type:feature"
"Epic 3 — Story 3.2: All‑pairs scheduler","User story:\nAs a system, I need a stable all‑pairs schedule so that every unique pair is simulated predictably.\n\nAcceptance criteria:\n- Generates unordered unique pairs for M actors; complexity O(M² × R).\n- Ordering is stable; artifacts reflect the schedule deterministically.\n\nTechnical notes:\n- Deterministic ordering by actor id; avoid duplicates (A,B) vs (B,A).\n\nLinks:\n- docs/stories/epic-3-simulation-engine.md#story-32--allpairs-scheduler","epic:engine,type:feature"
"Epic 3 — Story 3.3: Random schedule (seeded)","User story:\nAs a system, I need a random scheduler so that worlds can diversify interaction orders.\n\nAcceptance criteria:\n- Supports shuffle‑all and sample‑per‑round modes; both seeded.\n- Switching modes is recorded in the run manifest; outputs remain reproducible.\n\nTechnical notes:\n- Use seeded shuffles; ensure no duplicate or missing pairings per round.\n\nLinks:\n- docs/stories/epic-3-simulation-engine.md#story-33--random-schedule-seeded","epic:engine,type:feature"
"Epic 3 — Story 3.4: Pairwise execution loop","User story:\nAs a system, I need to execute pairwise rounds so that strategies can interact and score.\n\nAcceptance criteria:\n- Supports Finite State Machine and Code strategies; validates emitted decisions.\n- Applies payoff, updates state, and accumulates per‑actor totals each round.\n\nTechnical notes:\n- Tight inner loop; reuse buffers; per‑decision timeout enforced.\n\nLinks:\n- docs/stories/epic-3-simulation-engine.md#story-34--pairwise-execution-loop","epic:engine,type:feature"
"Epic 3 — Story 3.5: Limits and timeouts","User story:\nAs an operator, I need guardrails so that runs finish and resources are protected.\n\nAcceptance criteria:\n- Per‑decision step timeout and overall run timeout enforced; clear error codes.\n- Maximum steps bound prevents pathological runs; failures recorded in summary.\n\nTechnical notes:\n- Abort and mark run status as failed/invalid with reason; partial artifacts allowed.\n\nLinks:\n- docs/stories/epic-3-simulation-engine.md#story-35--limits-and-timeouts","epic:engine,type:feature,area:reliability"
"Epic 3 — Story 3.6: Artifact generation","User story:\nAs a user, I want run artifacts so that I can analyze results later.\n\nAcceptance criteria:\n- Writes run_summary.json, pairwise_matrix.json (or Parquet), and optional traces.\n- Artifacts referenced by a manifest; signed URLs issued on request.\n\nTechnical notes:\n- Store to object storage under /runs/{run_id}/; record checksums and sizes.\n\nLinks:\n- docs/stories/epic-3-simulation-engine.md#story-36--artifact-generation","epic:engine,type:feature,area:storage"
"Epic 3 — Story 3.7: Golden‑run tests","User story:\nAs a developer, I want golden tests so that determinism regressions are caught in continuous integration.\n\nAcceptance criteria:\n- Fixed inputs produce byte‑identical summaries and matrices; test fails on drift.\n\nTechnical notes:\n- Store golden artifacts in test fixtures; add CI step to compare outputs.\n\nLinks:\n- docs/stories/epic-3-simulation-engine.md#story-37--goldenrun-tests","epic:engine,type:test"
"Epic 4 — Story 4.1: Leaderboard (latest)","User story:\nAs a spectator, I want a leaderboard so that I can see top performers at a glance.\n\nAcceptance criteria:\n- Sorted by average score; shows variance and entries count.\n- Cached for fast loads; links to underlying run details.\n\nTechnical notes:\n- GET /worlds/{id}/leaderboard returns latest leaderboard; cache in Redis.\n\nLinks:\n- docs/stories/epic-4-analytics.md#story-41--leaderboard-latest","epic:analytics,type:feature,area:web"
"Epic 4 — Story 4.2: Key Performance Indicator snapshots","User story:\nAs a world creator, I want Key Performance Indicator snapshots so that I can track trends across runs.\n\nAcceptance criteria:\n- Key Performance Indicators evaluated per run, stored and listed chronologically.\n- Compare view shows last N runs with deltas.\n\nTechnical notes:\n- Compute after run completion; persist to kpi_snapshots; expose via GET /worlds/{id}/kpis?run_id=...\n\nLinks:\n- docs/stories/epic-4-analytics.md#story-42--key-performance-indicator-snapshots","epic:analytics,type:feature"
"Epic 4 — Story 4.3: Pairwise matrix API","User story:\nAs a researcher, I want pairwise metrics so that I can analyze interactions between actors.\n\nAcceptance criteria:\n- Returns average payoff, outcome distribution (C/C, C/D, D/C, D/D), first defection round, punish duration.\n- Supports filtering by cohorts and round windows (subscriber).\n\nTechnical notes:\n- Backed by pairwise_matrix artifact; derive cohorts/windows server-side.\n\nLinks:\n- docs/stories/epic-4-analytics.md#story-43--pairwise-matrix-application-programming-interface","epic:analytics,type:feature,gating:subscriber"
"Epic 4 — Story 4.4: Replays (subscriber)","User story:\nAs a subscriber, I want seeded replays so that I can inspect pivotal moments.\n\nAcceptance criteria:\n- Timeline with event markers (first D, forgiveness threshold, switches).\n- Step controls; shows the seed and allows change when permitted.\n\nTechnical notes:\n- Store sampled trace for selected pairs; derive event markers during trace save.\n\nLinks:\n- docs/stories/epic-4-analytics.md#story-44--replays-subscriber","epic:analytics,type:feature,gating:subscriber"
"Epic 4 — Story 4.5: Gating and exports (subscriber)","User story:\nAs a product, I want analytics gating so that premium features drive conversion.\n\nAcceptance criteria:\n- Filters and drilldowns are locked for free users with teasers.\n- Export aggregated stats (CSV/JSON) available to subscribers only.\n\nTechnical notes:\n- Entitlements middleware gates Application Programming Interface routes; UI hides or shows CTAs.\n\nLinks:\n- docs/stories/epic-4-analytics.md#story-45--gating-and-exports-subscriber","epic:analytics,type:feature,gating:subscriber"
"Epic 5 — Story 5.1: Sign in and profile","User story:\nAs a user, I want to sign in and view my profile so that my content and entitlements are tied to my identity.\n\nAcceptance criteria:\n- Supports sign in via Google and GitHub OAuth, plus email magic-link fallback.\n- On first sign in, a user record is created with display name and roles defaulted.\n- Profile page shows: email, display name, roles, current subscription status, remaining simulation runs.\n- Sign out clears tokens/cookies; protected pages redirect to sign in.\n\nTechnical notes:\n- Implement OAuth providers; persist users; secure cookie/session handling.\n\nLinks:\n- docs/stories/epic-5-platform.md#story-51--sign-in-and-profile","epic:platform,type:feature,area:auth"
"Epic 5 — Story 5.2: Manage subscriptions (entitlements)","User story:\nAs a customer, I want my subscription to unlock features so that I can access subscriber-only capabilities.\n\nAcceptance criteria:\n- Subscription records created/updated via payment provider webhook (user_subscriptions).\n- Application Programming Interface endpoint /me/entitlements returns flags (analytics_access, quick_test_access, private_worlds).\n- Entitlements are applied server-side to gate endpoints and client-side to hide locked UI.\n- When subscription expires, flags are revoked immediately.\n\nTechnical notes:\n- Webhook signature verification; idempotency; entitlement caching.\n\nLinks:\n- docs/stories/epic-5-platform.md#story-52--manage-subscriptions-entitlements","epic:platform,type:feature,area:billing"
"Epic 5 — Story 5.3: Purchase and apply usage packs","User story:\nAs a user, I want to buy usage packs so that I can exceed my monthly allocation when needed.\n\nAcceptance criteria:\n- Usage pack catalog (actors, world_seed, simulation_runs, private_world).\n- Purchases recorded in user_purchases with quantities and timestamps.\n- Application Programming Interface applies pack balances to quotas on enqueue; balances decrement atomically.\n- Purchase history visible in profile/billing view.\n\nTechnical notes:\n- Atomic decrement with transaction; display remaining pack balances.\n\nLinks:\n- docs/stories/epic-5-platform.md#story-53--purchase-and-apply-usage-packs","epic:platform,type:feature,area:billing"
"Epic 5 — Story 5.4: Enforce simulation quotas with rollover","User story:\nAs a user, I want clear simulation run limits with rollover so that I can plan my runs.\n\nAcceptance criteria:\n- Quota = monthly_simulation_runs + rollover (capped at configured multiplier) − used.\n- On run enqueue: quota is checked and decremented atomically; on failure, user receives clear error and call to action.\n- Rollover is applied at month boundary up to cap; unused runs beyond cap are dropped.\n- UI meter shows remaining runs and rollover cap; Application Programming Interface exposes /usage.\n\nTechnical notes:\n- Monthly cron to apply rollover; counters table with atomic updates.\n\nLinks:\n- docs/stories/epic-5-platform.md#story-54--enforce-simulation-quotas-with-rollover","epic:platform,type:feature,area:quotas"
"Epic 5 — Story 5.5: Access control for private content","User story:\nAs a creator, I want private worlds and strategies so that only I (and later, my team) can access them.\n\nAcceptance criteria:\n- World/strategy visibility = public | private; private requires owner identity.\n- Application Programming Interface enforces resource-level authorization; attempts by non-owners return 404 to avoid info leaks.\n- Listings filter out private resources for non-owners; owners see their private items.\n- Future: organization/team membership placeholder included in schema (no UI yet).\n\nTechnical notes:\n- Middleware for ownership checks; consistent 404 behavior for unauthorized.\n\nLinks:\n- docs/stories/epic-5-platform.md#story-55--access-control-for-private-content","epic:platform,type:feature,area:auth"
"Epic 5 — Story 5.6: Secure artifact delivery and audit trail","User story:\nAs a user, I want secure links to run artifacts so that my data is protected.\n\nAcceptance criteria:\n- Artifacts (manifest, summary, pairwise, traces) are retrieved via time‑limited signed URLs.\n- Run manifest includes seed, parameters, artifact checksums, and signature.\n- Access to artifact URLs is only issued to authorized users for the run’s world.\n- Read access is logged with timestamp and user id for audit.\n\nTechnical notes:\n- Signed URL generation; audit logging table; permission checks per run.\n\nLinks:\n- docs/stories/epic-5-platform.md#story-56--secure-artifact-delivery-and-audit-trail","epic:platform,type:feature,area:security"
"Epic 5 — Story 5.7: Admin: webhooks and reconciliation","User story:\nAs an operator, I want robust webhook handling so that subscriptions and packs stay consistent.\n\nAcceptance criteria:\n- Idempotent webhook endpoints with signature verification and replay protection.\n- Dead-letter queue for failed webhook processing; retries with backoff.\n- Nightly reconciliation job compares provider state to user_subscriptions/user_purchases and fixes drifts; emits report.\n\nTechnical notes:\n- Background job scheduler; DLQ; observability for webhook outcomes.\n\nLinks:\n- docs/stories/epic-5-platform.md#story-57--admin-webhooks-and-reconciliation","epic:platform,type:feature,area:billing,area:ops"

